{
  "product_type": "Revolving Credit",
  "schema_details": {
    "fields_definition": {
      "client_id": { "type": "reference", "format": "string", "mandatory": true },
      "limit_amount": { "type": "currency", "format": "float", "mandatory": true },
      "currency": { "type": "reference", "format": "ISO-4217", "mandatory": true },
      "commitment_fee_bps": { "type": "basis_points", "format": "int", "mandatory": true },
      "utilization_threshold": { "type": "percentage", "format": "float", "mandatory": true },
      "availability_period_end": { "type": "date", "format": "YYYY-MM-DD", "mandatory": false },
      "syndication_flag": { "type": "boolean", "format": "string", "mandatory": false }
    },
    "reference_data": {
      "currency": ["USD", "GBP", "EUR"],
      "sector": ["TMT", "Energy", "Financial Institutions"],
      "syndication_flag": ["Yes", "No"]
    },
    "derivation_targets": {
      "reference_mapped": ["risk_rating_code", "limit_type_code"],
      "calculated": ["total_commitment_fee"]
    }
  },
  "target_api_payload": {
    "client_id": "{{client_id}}",
    "availability_period_end": "{{availability_period_end}}",
    "syndication_flag": "{{syndication_flag}}",
    "is_syndicated": "{{syndication_flag == 'Yes' ? true : false}}",
    "risk_rating_code": "{{risk_rating_code}}",
    "total_commitment_fee": "{{total_commitment_fee}}",
    "facility_limits": [
      {
        "limit_amount": "{{limit_amount}}",
        "currency": "{{currency}}",
        "commitment_fee_bps": "{{commitment_fee_bps}}",
        "utilization_threshold": "{{utilization_threshold}}",
        "utilization_threshold_pct": "{{utilization_threshold * 100}}"
      }
    ]
  }
}
